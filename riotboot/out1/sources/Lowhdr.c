/* 
  This file was generated by KreMLin <https://github.com/FStarLang/kremlin>
  KreMLin invocation: krml -verbose -d reachability -I . -I includes -tmpdir /Users/syuan/GoogleDrive/PhD/FstarCode/LCTES2021/riotboot/out/sources -no-prefix FStarFiles /Users/syuan/GoogleDrive/PhD/FstarCode/LCTES2021/riotboot/out/out.krml -ccopt -O0 main.c -add-include "kremlin/internal/compat.h" -bundle LowStar.*,Prims -bundle FStar.* -o /Users/syuan/GoogleDrive/PhD/FstarCode/LCTES2021/riotboot/out/LowKernel
  F* version: cfb65605
  KreMLin version: 03ccd42f
 */

#include "Lowhdr.h"

uint32_t Lowhdr_rm = (uint32_t)0x544f4952U;

uint16_t Lowhdr_offset_chksum = (uint16_t)6U;

void Lowhdr_rb_hdr_t2uint16_t(RbComm_rb_hdr_t s, uint16_t *d)
{
  d[0U] = (uint16_t)s.magic_number;
  d[1U] = (uint16_t)(s.magic_number >> (uint32_t)16U);
  d[2U] = (uint16_t)s.version;
  d[3U] = (uint16_t)(s.version >> (uint32_t)16U);
  d[4U] = (uint16_t)s.start_addr;
  d[5U] = (uint16_t)(s.start_addr >> (uint32_t)16U);
}

uint32_t Lowhdr_rb_hdr_checksum_aux(RbComm_rb_hdr_t h)
{
  uint16_t tb[8U] = { 0U };
  Lowhdr_rb_hdr_t2uint16_t(h, tb);
  uint32_t res = LowFletcher32_fletcher32(Lowhdr_offset_chksum, tb);
  return res;
}

uint32_t Lowhdr_rb_hdr_checksum(RbComm_rb_hdr_t *b)
{
  return Lowhdr_rb_hdr_checksum_aux(b[0U]);
}

bool Lowhdr_rb_hdr_validate(RbComm_rb_hdr_t *h)
{
  RbComm_rb_hdr_t h1 = h[0U];
  uint32_t hc = Lowhdr_rb_hdr_checksum(h);
  if (h1.magic_number == Lowhdr_rm && hc == h1.chksum)
    return true;
  else
    return false;
}

